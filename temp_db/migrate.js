const { MongoClient, ObjectId } = require('mongodb');

const uri = "mongodb://news8kdbuser:QzKg09S1EiKy-VWmPBOxm7q0gbxP9ds3WwTp6fWrszzmk_KL@be9a526b-891c-4295-bdfb-a64a74b98b8d.nam5.firestore.goog:443/knewsdb?loadBalanced=true&tls=true&authMechanism=SCRAM-SHA-256&retryWrites=false";

const newsData = [
    {
        id: 'main-1',
        title: 'à°®à±†à°¯à°¿à°¨à± à°¨à±à°¯à±‚à°¸à±: à°ªà±à°°à°ªà°‚à°š à°†à°°à±à°¥à°¿à°• à°µà±à°¯à°µà°¸à±à°¥à°²à±‹ à°ªà±†à°¨à± à°®à°¾à°°à±à°ªà±à°²à±',
        description: 'à°…à°‚à°¤à°°à±à°œà°¾à°¤à±€à°¯ à°®à°¾à°°à±à°•à±†à°Ÿà±à°²à°²à±‹ à°šà±‹à°Ÿà± à°šà±‡à°¸à±à°•à±à°‚à°Ÿà±à°¨à±à°¨ à°®à°¾à°°à±à°ªà±à°²à± à°­à°¾à°°à°¤ à°†à°°à±à°¥à°¿à°• à°µà±à°¯à°µà°¸à±à°¥à°ªà±ˆ à°Žà°²à°¾à°‚à°Ÿà°¿ à°ªà±à°°à°­à°¾à°µà°‚ à°šà±‚à°ªà±à°¤à°¾à°¯à±‹ à°µà°¿à°¶à±à°²à±‡à°·à°¿à°‚à°šà°‚à°¡à°¿.',
        image: '05-Down to up scroll pop up.png',
        tags: ['main', 'trending']
    },
    {
        id: 'main-2',
        title: 'à°¦à±‡à°¶à°µà±à°¯à°¾à°ªà±à°¤à°‚à°—à°¾ à°¨à±‚à°¤à°¨ à°µà°¿à°¦à±à°¯à°¾ à°µà°¿à°§à°¾à°¨à°‚ à°…à°®à°²à±',
        description: 'à°ªà±à°°à°­à±à°¤à±à°µà°‚ à°ªà±à°°à°•à°Ÿà°¿à°‚à°šà°¿à°¨ à°¨à±‚à°¤à°¨ à°µà°¿à°¦à±à°¯à°¾ à°µà°¿à°§à°¾à°¨à°‚ à°µà°²à±à°² à°µà°¿à°¦à±à°¯à°¾à°°à±à°¥à±à°²à°•à± à°•à°²à°¿à°—à±‡ à°ªà±à°°à°¯à±‹à°œà°¨à°¾à°²à± à°®à°°à°¿à°¯à± à°®à°¾à°°à±à°ªà±à°² à°—à±à°°à°¿à°‚à°šà°¿ à°¤à±†à°²à±à°¸à±à°•à±‹à°‚à°¡à°¿.',
        image: '06-8K News.png',
        tags: ['main', 'trending']
    },
    {
        id: 'main-3',
        title: 'à°­à°¾à°°à°¤ à°…à°‚à°¤à°°à°¿à°•à±à°· à°ªà°°à°¿à°¶à±‹à°§à°¨à°²à±‹ à°®à°°à±‹ à°®à±ˆà°²à±à°°à°¾à°¯à°¿',
        description: 'à°‡à°¸à±à°°à±‹ à°ªà±à°°à°¯à±‹à°—à°¿à°‚à°šà°¿à°¨ à°¸à°°à°¿à°•à±Šà°¤à±à°¤ à°¶à°¾à°Ÿà°¿à°²à±ˆà°Ÿà± à°®à°°à±à°¸à°Ÿà°¿ à°•à°•à±à°·à±à°¯à°²à±‹à°•à°¿ à°ªà±à°°à°µà±‡à°¶à°¿à°‚à°šà°¿ à°µà°¿à°œà°¯à°µà°‚à°¤à°‚à°—à°¾ à°ªà°¨à°¿ à°šà±‡à°¸à±à°¤à±‹à°‚à°¦à°¿.',
        image: '07-Up to down scroll.png',
        tags: ['main', 'trending']
    },
    {
        id: 'main-4',
        title: 'à°œà°¾à°¤à±€à°¯ à°¹à±ˆà°µà±‡ à°ªà±à°°à°¾à°œà±†à°•à±à°Ÿà±à°² à°ªà±à°°à°¾à°°à°‚à°­à°‚',
        description: 'à°¦à±‡à°¶à°µà±à°¯à°¾à°ªà±à°¤à°‚à°—à°¾ à°°à°µà°¾à°£à°¾ à°¸à±Œà°•à°°à±à°¯à°¾à°²à°¨à± à°®à±†à°°à±à°—à±à°ªà°°à°šà°¡à°¾à°¨à°¿à°•à°¿ à°µà±‡à°² à°•à±‹à°Ÿà±à°² à°°à±‚à°ªà°¾à°¯à°²à°¤à±‹ à°¨à±‚à°¤à°¨ à°°à°¹à°¦à°¾à°°à±à°² à°¨à°¿à°°à±à°®à°¾à°£à°‚.',
        image: '20-Main News.png',
        tags: ['main']
    },
    {
        id: 'cine-1',
        title: 'à°ªà±à°·à±à°ª 2: à°¦à°¿ à°°à±‚à°²à± - à°ªà±à°°à°ªà°‚à°šà°µà±à°¯à°¾à°ªà±à°¤ à°¸à°‚à°šà°²à°¨à°‚',
        description: 'à°…à°²à±à°²à± à°…à°°à±à°œà±à°¨à± à°¨à°Ÿà°¨ à°®à°°à°¿à°¯à± à°¸à±à°•à±à°®à°¾à°°à± à°¦à°°à±à°¶à°•à°¤à±à°µà°‚ à°ªà±à°·à±à°ª 2 à°šà°¿à°¤à±à°°à°¾à°¨à±à°¨à°¿ à°¬à°¾à°•à±à°¸à°¾à°«à±€à°¸à± à°µà°¦à±à°¦ à°µà°¿à°œà±‡à°¤à°—à°¾ à°¨à°¿à°²à°¬à±†à°Ÿà±à°Ÿà°¾à°¯à°¿.',
        image: '8K News_Trending page-23.png',
        tags: ['cinema', 'trending']
    },
    {
        id: 'cine-2',
        title: 'à°Ÿà°¾à°²à±€à°µà±à°¡à± à°…à°ªà±â€Œà°•à°®à°¿à°‚à°—à± à°¬à°¿à°—à± à°¬à°¡à±à°œà±†à°Ÿà± à°¸à°¿à°¨à°¿à°®à°¾à°²à±',
        description: 'à°¤à±à°µà°°à°²à±‹ à°µà°¿à°¡à±à°¦à°² à°•à°¾à°¬à±‹à°¤à±à°¨à±à°¨ à°Ÿà°¾à°ªà± à°¹à±€à°°à±‹à°² à°šà°¿à°¤à±à°°à°¾à°² à°Ÿà±€à°œà°°à±à°¸à± à°®à°°à°¿à°¯à± à°Ÿà±à°°à±ˆà°²à°°à±à°¸à± à°¸à±‹à°·à°²à± à°®à±€à°¡à°¿à°¯à°¾à°²à±‹ à°µà±ˆà°°à°²à± à°…à°µà±à°¤à±à°¨à±à°¨à°¾à°¯à°¿.',
        image: '20-Photos-1.png',
        tags: ['cinema', 'trending']
    },
    {
        id: 'cine-3',
        title: 'à°—à±à°²à±‹à°¬à°²à± à°¸à°¿à°¨à°¿à°®à°¾ à°µà±‡à°¦à°¿à°•à°ªà±ˆ à°Ÿà°¾à°²à±€à°µà±à°¡à± à°¸à°¤à±à°¤à°¾',
        description: 'à°®à°¨ à°¤à±†à°²à±à°—à± à°¸à°¿à°¨à°¿à°®à°¾à°²à± à°…à°‚à°¤à°°à±à°œà°¾à°¤à±€à°¯ à°µà±‡à°¦à°¿à°•à°²à°ªà±ˆ à°…à°µà°¾à°°à±à°¦à±à°²à± à°—à±†à°²à±à°šà±à°•à±à°‚à°Ÿà±‚ à°¤à±†à°²à±à°—à± à°œà±†à°‚à°¡à°¾à°¨à± à°Žà°—à°°à±‡à°¸à±à°¤à±à°¨à±à°¨à°¾à°¯à°¿.',
        image: '22-Photos-3.png',
        tags: ['cinema']
    },
    {
        id: 'bhakti-1',
        title: 'à°†à°§à±à°¯à°¾à°¤à±à°®à°¿à°• à°¶à°¾à°‚à°¤à°¿: à°§à±à°¯à°¾à°¨à°‚ à°ªà±à°°à°¾à°®à±à°–à±à°¯à°¤',
        description: 'à°§à±à°¯à°¾à°¨à°‚ à°šà±‡à°¯à°¡à°‚ à°µà°²à±à°² à°®à°¨à°¸à±à°¸à± à°ªà±à°°à°¶à°¾à°‚à°¤à°‚à°—à°¾ à°‰à°‚à°¡à°Ÿà°®à±‡ à°•à°¾à°•à±à°‚à°¡à°¾ à°†à°°à±‹à°—à±à°¯à°‚ à°•à±‚à°¡à°¾ à°®à±†à°°à±à°—à±à°ªà°¡à±à°¤à±à°‚à°¦à°¿.',
        image: '25-Category complete-2.png',
        tags: ['bhakti', 'trending'],
        isFullCard: true
    },
    {
        id: 'bhakti-2',
        title: 'à°ªà±à°°à°¸à°¿à°¦à±à°§ à°ªà±à°£à±à°¯à°•à±à°·à±‡à°¤à±à°°à°¾à°² à°¦à°°à±à°¶à°¨à°‚ - à°¯à°¾à°¤à±à°°à°¾ à°µà°¿à°¶à±‡à°·à°¾à°²à±',
        description: 'à°ˆ à°ªà°‚à°¡à±à°— à°¸à±€à°œà°¨à± à°²à±‹ à°¤à°ªà±à°ªà°• à°¸à°‚à°¦à°°à±à°¶à°¿à°‚à°šà°¾à°²à±à°¸à°¿à°¨ à°®à±à°–à±à°¯à°®à±ˆà°¨ à°¦à°°à±à°¶à°¨à±€à°¯ à°•à±à°·à±‡à°¤à±à°°à°¾à°² à°œà°¾à°¬à°¿à°¤à°¾ à°®à±€ à°•à±‹à°¸à°‚.',
        image: '25-Category complete-3.png',
        tags: ['bhakti'],
        isFullCard: true
    },
    {
        id: 'bhakti-3',
        title: 'à°®Ñ…Ð° à°¶à°¿à°µà°°à°¾à°¤à±à°°à°¿ à°µà±‡à°¡à±à°•à°² à°•à±‹à°¸à°‚ à°¸à°¿à°¦à±à°§à°®à°µà±à°¤à±à°¨à±à°¨ à°†à°²à°¯à°¾à°²à±',
        description: 'à°¶à±ˆà°µ à°•à±à°·à±‡à°¤à±à°°à°¾à°²à°²à±‹ à°®à°¹à°¾ à°¶à°¿à°µà°°à°¾à°¤à±à°°à°¿ à°¸à°‚à°¦à°°à±à°­à°‚à°—à°¾ à°µà°¿à°¦à±à°¯à±à°¤à± à°¦à±€à°ªà°¾à°²à°¤à±‹ à°…à°²à°‚à°•à°°à°£ à°®à°°à°¿à°¯à± à°ªà±à°°à°¤à±à°¯à±‡à°• à°ªà±‚à°œà°²à±.',
        image: '25-Category complete-4.png',
        tags: ['bhakti', 'trending'],
        isFullCard: true
    },
    {
        id: 'agri-1',
        title: 'à°µà±à°¯à°µà°¸à°¾à°¯à°‚à°²à±‹ à°¡à±à°°à±‹à°¨à± à°Ÿà±†à°•à±à°¨à°¾à°²à°œà±€ à°µà°¿à°¨à°¿à°¯à±‹à°—à°‚',
        description: 'à°°à±ˆà°¤à±à°²à°•à± à°¸à°¾à°—à±à°²à±‹ à°¸à°¹à°¾à°¯à°‚ à°šà±‡à°¯à°¡à°¾à°¨à°¿à°•à°¿ à°ªà±à°°à°­à±à°¤à±à°µà°‚ à°ªà±à°°à°µà±‡à°¶à°ªà±†à°Ÿà±à°Ÿà°¿à°¨ à°®à°²à±à°Ÿà±€-à°ªà°°à±à°ªà°¸à± à°¡à±à°°à±‹à°¨à±à°¸à± à°®à°‚à°šà°¿ à°«à°²à°¿à°¤à°¾à°²à°¨à± à°‡à°¸à±à°¤à±à°¨à±à°¨à°¾à°¯à°¿.',
        image: '24-Andhrapradesh News.png',
        tags: ['agriculture', 'trending']
    },
    {
        id: 'agri-2',
        title: 'à°¸à±‡à°‚à°¦à±à°°à±€à°¯ à°¸à°¾à°—à±à°¤à±‹ à°…à°§à°¿à°• à°²à°¾à°­à°¾à°²à±: à°°à±ˆà°¤à±à°² à°…à°¨à±à°­à°µà°‚',
        description: 'à°•à±†à°®à°¿à°•à°²à±à°¸à± à°µà°¾à°¡à°•à±à°‚à°¡à°¾ à°¸à°¹à°œ à°¸à°¿à°¦à±à°§à°‚à°—à°¾ à°ªà°‚à°¡à°¿à°‚à°šà°¿à°¨ à°ªà°‚à°Ÿà°²à°•à± à°®à°¾à°°à±à°•à±†à°Ÿà±à°²à±‹ à°®à°‚à°šà°¿ à°—à°¿à°°à°¾à°•à±€ à°à°°à±à°ªà°¡à°¿à°‚à°¦à°¿.',
        image: '26-India News-3.png',
        tags: ['agriculture', 'trending']
    },
    {
        id: 'agri-3',
        title: 'à°—à±à°‚à°Ÿà±‚à°°à± à°®à°¿à°°à±à°šà°¿ à°¯à°¾à°°à±à°¡à±â€Œà°²à±‹ à°°à°¿à°•à°¾à°°à±à°¡à± à°²à°¾à°µà°¾à°¦à±‡à°µà±€à°²à±',
        description: 'à°ˆ à°à°¡à°¾à°¦à°¿ à°®à°¿à°°à±à°šà°¿ à°¦à°¿à°—à±à°¬à°¡à°¿ à°†à°¶à°¾à°œà°¨à°•à°‚à°—à°¾ à°‰à°‚à°¡à°Ÿà°‚à°¤à±‹ à°°à±ˆà°¤à±à°²à± à°¹à°°à±à°·à°‚ à°µà±à°¯à°•à±à°¤à°‚ à°šà±‡à°¸à±à°¤à±à°¨à±à°¨à°¾à°°à±.',
        image: '21-Local News.png',
        tags: ['agriculture', 'guntur', 'local']
    },
    {
        id: 'sports-1',
        title: 'à°•à±à°°à°¿à°•à±†à°Ÿà±: à°­à°¾à°°à°¤à± à°…à°¦à±à°­à±à°¤ à°µà°¿à°œà°¯à°‚',
        description: 'à°¤à±Šà°²à°¿ à°Ÿà±†à°¸à±à°Ÿà±à°²à±‹ à°ªà±à°°à°¤à±à°¯à°°à±à°¥à°¿ à°œà°Ÿà±à°Ÿà±à°¨à± à°®à°Ÿà±à°Ÿà°¿à°•à°°à°¿à°ªà°¿à°‚à°šà°¿à°¨ à°­à°¾à°°à°¤ à°œà°Ÿà±à°Ÿà±. à°°à±‹à°¹à°¿à°¤à± à°¶à°°à±à°® à°µà±€à°°à±‹à°šà°¿à°¤ à°¸à±†à°‚à°šà°°à±€.',
        image: '06-8K News.png',
        tags: ['sports', 'trending']
    },
    {
        id: 'sports-2',
        title: 'à°¨à±‡à°·à°¨à°²à± à°—à±‡à°®à±à°¸à±: à°¤à±†à°²à±à°—à± à°°à°¾à°·à±à°Ÿà±à°°à°¾à°² à°•à±à°°à±€à°¡à°¾à°•à°¾à°°à±à°² à°œà±‹à°°à±',
        description: 'à°ªà°²à± à°µà°¿à°­à°¾à°—à°¾à°²à±à°²à±‹ à°—à±‹à°²à±à°¡à± à°®à±†à°¡à°²à±à°¸à± à°—à±†à°²à±à°šà±à°•à±à°‚à°Ÿà±‚ à°®à°¨ à°…à°¥à±à°²à±†à°Ÿà±à°²à± à°¸à°¤à±à°¤à°¾ à°šà°¾à°Ÿà±à°¤à±à°¨à±à°¨à°¾à°°à±.',
        image: '08-8K News.png',
        tags: ['sports', 'trending']
    },
    {
        id: 'wish-1',
        title: 'à°¸à°‚à°•à±à°°à°¾à°‚à°¤à°¿ à°¶à±à°­à°¾à°•à°¾à°‚à°•à±à°·à°²à±: à°ªà°‚à°¡à±à°— à°¸à°‚à°¦à°¡à°¿',
        description: 'à°®à±à°‚à°—à°¿à°Ÿ à°®à±à°—à±à°—à±à°²à±, à°—à±Šà°¬à±à°¬à±†à°®à±à°®à°²à± à°®à°°à°¿à°¯à± à°•à±‹à°¡à°¿ à°ªà°‚à°¦à±‡à°²à°¤à±‹ à°ªà°²à±à°²à±†à°²à±à°²à±‹ à°ªà°‚à°¡à±à°— à°µà°¾à°¤à°¾à°µà°°à°£à°‚ à°¨à±†à°²à°•à±Šà°‚à°¦à°¿.',
        image: '26-India News.png',
        tags: ['wishes', 'whatsapp']
    },
    {
        id: 'wish-2',
        title: 'à°¹à±à°¯à°¾à°ªà±€ à°¬à°°à±à°¤à±â€Œà°¡à±‡: à°µà°¿à°·à±†à°¸à± à°•à°¾à°°à±à°¡à±à°¸à±',
        description: 'à°®à±€ à°¸à±à°¨à±‡à°¹à°¿à°¤à±à°²à°•à± à°®à°°à°¿à°¯à± à°•à±à°Ÿà±à°‚à°¬ à°¸à°­à±à°¯à±à°²à°•à± à°ˆ à°ªà±à°°à°¤à±à°¯à±‡à°•à°®à±ˆà°¨ à°µà°¿à°·à±†à°¸à± à°®à±†à°¸à±‡à°œà±â€Œà°²à°¨à± à°ªà°‚à°ªà°‚à°¡à°¿.',
        image: '25-Category complete-5.png',
        tags: ['wishes', 'whatsapp', 'trending'],
        isFullCard: true
    },
    {
        id: 'wa-1',
        title: 'à°²à±‡à°Ÿà±†à°¸à±à°Ÿà± à°®à±Šà°Ÿà°¿à°µà±‡à°·à°¨à°²à± à°¸à±à°Ÿà±‡à°Ÿà°¸à± à°µà±€à°¡à°¿à°¯à±‹à°²à±',
        description: 'à°œà±€à°µà°¿à°¤à°‚à°²à±‹ à°à°¦à±ˆà°¨à°¾ à°¸à°¾à°§à°¿à°‚à°šà°¾à°²à°¨à±à°•à±à°¨à±‡ à°µà°¾à°°à°¿à°•à°¿ à°¸à±à°«à±‚à°°à±à°¤à°¿à°¨à°¿à°šà±à°šà±‡ à°…à°¦à±à°­à±à°¤à°®à±ˆà°¨ à°¸à±à°Ÿà±‡à°Ÿà°¸à± à°•à°²à±†à°•à±à°·à°¨à±.',
        image: '25 Telangana News.png',
        tags: ['whatsapp']
    },
    {
        id: 'wa-2',
        title: 'à°µà±ˆà°°à°²à± à°µà°¾à°Ÿà±à°¸à°¾à°ªà± à°¸à±à°Ÿà±‡à°Ÿà°¸à± à°…à°ªà±â€Œà°¡à±‡à°Ÿà±à°¸à±',
        description: 'à°¸à±‹à°·à°²à± à°®à±€à°¡à°¿à°¯à°¾à°²à±‹ à°Ÿà±à°°à±†à°‚à°¡à°¿à°‚à°—à± à°²à±‹ à°‰à°¨à±à°¨ à°µà±€à°¡à°¿à°¯à±‹à°²à± à°®à°°à°¿à°¯à± à°šà°¿à°¤à±à°°à°¾à°²à± à°‡à°•à±à°•à°¡ à°šà±‚à°¡à°‚à°¡à°¿.',
        image: '22-Trending News.png',
        tags: ['whatsapp', 'trending']
    },
    {
        id: 'loc-hyd-1',
        title: 'à°¹à±ˆà°¦à°°à°¾à°¬à°¾à°¦à±: à°à°Ÿà±€ à°•à°¾à°°à°¿à°¡à°¾à°°à± à°²à±‹ à°Ÿà±à°°à°¾à°«à°¿à°•à± à°†à°‚à°•à±à°·à°²à±',
        description: 'à°µà°¿à°®à°¾à°¨à°¶à±à°°à°¯à°‚ à°®à±†à°Ÿà±à°°à±‹ à°ªà°¨à±à°² à°¦à±ƒà°·à±à°Ÿà±à°¯à°¾ à°¨à°—à°°à°‚à°²à±‹ à°ªà°²à± à°šà±‹à°Ÿà±à°² à°Ÿà±à°°à°¾à°«à°¿à°•à± à°®à°³à±à°²à°¿à°‚à°ªà±à°²à± à°šà±‡à°ªà°Ÿà±à°Ÿà°¾à°°à±.',
        image: '19-8K News.png',
        tags: ['hyderabad', 'local', 'trending']
    },
    {
        id: 'andhra-1',
        title: 'à°†à°‚à°§à±à°°à°ªà±à°°à°¦à±‡à°¶à± à°µà°¾à°°à±à°¤à°²à±',
        description: 'à°†à°‚à°§à±à°°à°ªà±à°°à°¦à±‡à°¶à± à°°à°¾à°·à±à°Ÿà±à°°à°‚à°²à±‹ à°œà°°à±à°—à±à°¤à±à°¨à±à°¨ à°¤à°¾à°œà°¾ à°°à°¾à°œà°•à±€à°¯, à°¸à°¾à°®à°¾à°œà°¿à°• à°ªà°°à°¿à°£à°¾à°®à°¾à°²à± à°®à°°à°¿à°¯à± à°…à°­à°¿à°µà±ƒà°¦à±à°§à°¿ à°ªà°¨à±à°² à°µà°¿à°µà°°à°¾à°²à±.',
        image: 'andhra.png',
        tags: ['andhra', 'local']
    },
    {
        id: 'telangana-1',
        title: 'à°¤à±†à°²à°‚à°—à°¾à°£ à°µà°¾à°°à±à°¤à°²à±',
        description: 'à°¤à±†à°²à°‚à°—à°¾à°£ à°°à°¾à°·à±à°Ÿà±à°°à°‚à°²à±‹ à°…à°®à°²à± à°…à°µà±à°¤à±à°¨à±à°¨ à°ªà±à°°à°œà°¾ à°¸à°‚à°•à±à°·à±‡à°® à°ªà°¥à°•à°¾à°²à± à°®à°°à°¿à°¯à± à°¹à±ˆà°¦à°°à°¾à°¬à°¾à°¦à± à°¨à°—à°° à°…à°­à°¿à°µà±ƒà°¦à±à°§à°¿ à°µà°¿à°¶à±‡à°·à°¾à°²à±.',
        image: 'telangana.png',
        tags: ['telangana', 'local']
    },
    {
        id: 'national-1',
        title: 'à°œà°¾à°¤à±€à°¯ à°µà°¾à°°à±à°¤à°²à±',
        description: 'à°­à°¾à°°à°¤à°¦à±‡à°¶ à°µà±à°¯à°¾à°ªà±à°¤à°‚à°—à°¾ à°œà°°à±à°—à±à°¤à±à°¨à±à°¨ à°®à±à°–à±à°¯à°®à±ˆà°¨ à°µà°¾à°°à±à°¤à°²à±, à°•à±à°°à±€à°¡à°²à± à°®à°°à°¿à°¯à± à°‡à°¤à°° à°ªà±à°°à°§à°¾à°¨ à°µà°¿à°¶à±‡à°·à°¾à°²à±.',
        image: 'national.png',
        tags: ['national']
    },
    {
        id: 'loc-hyd-2',
        title: 'à°¨à°—à°°à°‚à°²à±‹ à°­à°¾à°°à±€ à°µà°°à±à°· à°¸à±‚à°šà°¨: à°¹à±ˆ à°…à°²à°°à±à°Ÿà±',
        description: 'à°°à°¾à°¨à±à°¨à±à°¨ 24 à°—à°‚à°Ÿà°²à±à°²à±‹ à°¹à±ˆà°¦à°°à°¾à°¬à°¾à°¦à± à°¤à±‹ à°ªà°¾à°Ÿà± à°ªà°²à± à°œà°¿à°²à±à°²à°¾à°²à±à°²à±‹ à°­à°¾à°°à±€ à°µà°°à±à°·à°¾à°²à± à°•à±à°°à°¿à°¸à±‡ à°…à°µà°•à°¾à°¶à°‚ à°‰à°‚à°¦à°¿.',
        image: '21-Local News.png',
        tags: ['hyderabad', 'local']
    },
    {
        id: 'loc-gun-1',
        title: 'à°—à±à°‚à°Ÿà±‚à°°à±: à°…à°­à°¿à°µà±ƒà°¦à±à°§à°¿ à°ªà°¨à±à°² à°µà±‡à°—à°µà°‚à°¤à°‚',
        description: 'à°¨à°—à°° à°…à°­à°¿à°µà±ƒà°¦à±à°§à°¿ à°•à±‹à°¸à°‚ à°®à°‚à°œà±‚à°°à±ˆà°¨ à°¨à°¿à°§à±à°²à°¤à±‹ à°•à±Šà°¤à±à°¤ à°°à±‹à°¡à±à°²à± à°®à°°à°¿à°¯à± à°¡à±à°°à±ˆà°¨à±‡à°œà±€ à°ªà°¨à±à°²à± à°ªà±à°°à°¾à°°à°‚à°­à°‚.',
        image: '24-Andhrapradesh News.png',
        tags: ['guntur', 'local', 'trending']
    },
    {
        id: 'life-1',
        title: 'à°†à°°à±‹à°—à±à°¯à°•à°°à°®à±ˆà°¨ à°†à°¹à°¾à°°à°ªà± à°…à°²à°µà°¾à°Ÿà±à°²à±: à°šà°¿à°Ÿà±à°•à°¾à°²à±',
        description: 'à°ªà±à°°à°¤à°¿à°°à±‹à°œà±‚ à°¤à°¾à°œà°¾ à°•à±‚à°°à°—à°¾à°¯à°²à± à°®à°°à°¿à°¯à± à°ªà°‚à°¡à±à°²à°¨à± à°®à±€ à°¡à±ˆà°Ÿà± à°²à±‹ à°šà±‡à°°à±à°šà±à°•à±‹à°µà°¡à°‚ à°µà°²à±à°² à°‡à°®à±à°¯à±‚à°¨à°¿à°Ÿà±€ à°ªà±†à°°à±à°—à±à°¤à±à°‚à°¦à°¿.',
        image: '23-Photos-4.png',
        tags: ['lifestyle', 'trending']
    },
    {
        id: 'life-2',
        title: 'à°®à±‹à°¡à±à°°à°¨à± à°¹à±‹à°®à± à°‡à°‚à°Ÿà±€à°°à°¿à°¯à°°à± à°¡à°¿à°œà±ˆà°¨à±à°¸à± 2024',
        description: 'à°¤à°•à±à°•à±à°µ à°–à°°à±à°šà±à°¤à±‹ à°®à±€ à°‡à°‚à°Ÿà°¿à°¨à°¿ à°…à°‚à°¦à°‚à°—à°¾ à°®à°¾à°°à±à°šà±à°•à±à°¨à±‡ à°¸à°°à°¿à°•à±Šà°¤à±à°¤ à°‡à°‚à°Ÿà±€à°°à°¿à°¯à°°à± à°à°¡à°¿à°¯à°¾à°²à±.',
        image: '24-Photos-5.png',
        tags: ['lifestyle', 'trending']
    },
    {
        id: 'aff-1',
        title: 'à°•à°°à±†à°‚à°Ÿà± à°…à°«à±ˆà°°à±à°¸à±: à°°à°¾à°·à±à°Ÿà±à°° à°¬à°¡à±à°œà±†à°Ÿà± à°µà°¿à°¶à±à°²à±‡à°·à°£',
        description: 'à°ªà±à°°à°­à±à°¤à±à°µà°‚ à°ªà±à°°à°•à°Ÿà°¿à°‚à°šà°¿à°¨ à°°à°¾à°¬à±‹à°¯à±‡ à°†à°°à±à°¥à°¿à°• à°¸à°‚à°µà°¤à±à°¸à°° à°¬à°¡à±à°œà±†à°Ÿà± à°ªà±ˆ à°ªà±‚à°°à±à°¤à°¿ à°…à°µà°—à°¾à°¹à°¨ à°ªà±Šà°‚à°¦à°‚à°¡à°¿.',
        image: '26-India News-2.png',
        tags: ['affairs', 'trending']
    },
    {
        id: 'aff-2',
        title: 'à°®à±†à°°à±à°—à±ˆà°¨ à°ªà°¾à°²à°¨ à°•à±‹à°¸à°‚ à°¡à°¿à°œà°¿à°Ÿà°²à± à°°à°¿à°«à°¾à°°à±à°®à±à°¸à±',
        description: 'à°ªà±à°°à°­à±à°¤à±à°µ à°¸à±‡à°µà°²à°¨à± à°ªà±à°°à°œà°²à°•à± à°®à°°à°¿à°‚à°¤ à°¸à±à°²à°­à°‚à°—à°¾ à°šà±‡à°°à°µà±‡à°¸à±‡à°‚à°¦à±à°•à± à°Ÿà±†à°•à±à°¨à°¾à°²à°œà±€ à°µà°¿à°¨à°¿à°¯à±‹à°—à°‚.',
        image: '26-India News-3.png',
        tags: ['affairs', 'main']
    },
    {
        id: 'aff-3',
        title: 'à°…à°‚à°¤à°°à±à°œà°¾à°¤à±€à°¯ à°¸à°¦à°¸à±à°¸à±à°²à±‹ à°­à°¾à°°à°¤ à°ªà±à°°à°¤à°¿à°¨à°¿à°§à°¿ à°¬à±ƒà°‚à°¦à°‚',
        description: 'à°ªà°°à±à°¯à°¾à°µà°°à°£ à°®à°¾à°°à±à°ªà±à°²à°ªà±ˆ à°œà°°à±à°—à±à°¤à±à°¨à±à°¨ à°šà°°à±à°šà°²à±à°²à±‹ à°­à°¾à°—à°‚à°—à°¾ à°­à°¾à°°à°¤à± à°¤à°¨ à°¸à±à°µà°šà±à°› à°‡à°‚à°§à°¨ à°²à°•à±à°·à±à°¯à°¾à°²à°¨à± à°µà°¿à°µà°°à°¿à°‚à°šà°¿à°‚à°¦à°¿.',
        image: '26-India News-1.png',
        tags: ['affairs', 'trending']
    },
    {
        id: 'photo-1',
        title: 'à°­à°¾à°°à°¤à°¦à±‡à°¶ à°…à°¦à±à°­à±à°¤ à°ªà±à°°à°•à±ƒà°¤à°¿ à°¦à±ƒà°¶à±à°¯à°¾à°²à±',
        description: 'à°¹à°¿à°®à°¾à°²à°¯à°¾à°² à°¨à±à°‚à°¡à°¿ à°•à°¨à±à°¯à°¾à°•à±à°®à°¾à°°à°¿ à°µà°°à°•à± à°®à°¨ à°¦à±‡à°¶ à°¸à±Œà°‚à°¦à°°à±à°¯à°‚ à°«à±Šà°Ÿà±‹à°²à°²à±‹.',
        image: '21-Photos-2.png',
        tags: ['photos', 'trending']
    },
    {
        id: 'video-1',
        title: 'à°¸à°¾à°‚à°•à±‡à°¤à°¿à°• à°µà°¿à°ªà±à°²à°µà°‚: à°µà±€à°¡à°¿à°¯à±‹ à°°à°¿à°ªà±‹à°°à±à°Ÿà±',
        description: 'à°°à°¾à°¬à±‹à°¯à±‡ à°•à°¾à°²à°‚à°²à±‹ à°à°¯à±‡ à°—à±à°¯à°¾à°¡à±à°œà±†à°Ÿà±à°¸à± à°®à°¨ à°œà±€à°µà°¿à°¤à°¾à°²à°¨à± à°¶à°¾à°¸à°¿à°‚à°šà°¬à±‹à°¤à±à°¨à±à°¨à°¾à°¯à±‹ à°šà±‚à°¡à°‚à°¡à°¿.',
        image: '8K News_Top Bar Video-1.png',
        tags: ['videos', 'trending'],
        isVideo: true
    },
    {
        id: 'video-new-2',
        title: 'à°¤à°¾à°œà°¾ à°µà±€à°¡à°¿à°¯à±‹ à°µà°¾à°°à±à°¤à°²à±',
        description: 'à°°à°‚à°¡à°¿ à°šà±‚à°¡à°‚à°¡à°¿! à°ˆ à°°à±‹à°œà± à°¸à±‹à°·à°²à± à°®à±€à°¡à°¿à°¯à°¾à°²à±‹ à°µà±ˆà°°à°²à± à°…à°µà±à°¤à±à°¨à±à°¨ à°†à°¸à°•à±à°¤à°¿à°•à°°à°®à±ˆà°¨ à°µà±€à°¡à°¿à°¯à±‹.',
        image: 'Picture11.png',
        tags: ['videos', 'trending'],
        isVideo: true
    },
    {
        id: 'wish-new-1',
        title: 'à°¦à±€à°ªà°¾à°µà°³à°¿ à°¶à±à°­à°¾à°•à°¾à°‚à°•à±à°·à°²à±',
        description: 'à°ˆ à°¦à±€à°ªà°¾à°µà°³à°¿ à°®à±€ à°‡à°‚à°Ÿ à°µà±†à°²à±à°—à±à°²à± à°¨à°¿à°‚à°ªà°¾à°²à°¨à°¿, à°¸à±à°–à°¸à°‚à°¤à±‹à°·à°¾à°²à°¤à±‹ à°µà°°à±à°§à°¿à°²à±à°²à°¾à°²à°¨à°¿ à°•à±‹à°°à±à°•à±à°‚à°Ÿà±à°¨à±à°¨à°¾à°®à±.',
        image: 'wishes1.png',
        tags: ['wishes', 'trending'],
        isFullCard: true
    },
    {
        id: 'tech-new-1',
        title: 'à°•à±Šà°¤à±à°¤ à°¸à±à°®à°¾à°°à±à°Ÿà±â€Œà°«à±‹à°¨à± à°°à°¿à°µà±à°¯à±‚ 2024',
        description: 'à°®à°¾à°°à±à°•à±†à°Ÿà±à°²à±‹à°•à°¿ à°µà°šà±à°šà°¿à°¨ à°²à±‡à°Ÿà±†à°¸à±à°Ÿà± à°«à±€à°šà°°à±à°¸à± à°¤à±‹ à°•à±‚à°¡à°¿à°¨ à°¸à±à°®à°¾à°°à±à°Ÿà±â€Œà°«à±‹à°¨à± à°ªà°¨à°¿à°¤à±€à°°à± à°Žà°²à°¾ à°‰à°‚à°¦à±‹ à°šà±‚à°¡à°‚à°¡à°¿.',
        image: '8K News_Top Bar Video-2.png',
        tags: ['videos', 'trending'],
        isVideo: true
    },
    {
        id: 'photo-new-1',
        title: 'à°ªà±à°°à°•à±ƒà°¤à°¿ à°…à°‚à°¦à°¾à°²à±: à°…à°°à°•à± à°²à±‹à°¯',
        description: 'à°µà°¿à°¶à°¾à°– à°®à°¨à±à°¯à°‚à°²à±‹ à°ªà°°à±à°¯à°¾à°Ÿà°•à±à°²à°¨à± à°•à°Ÿà±à°Ÿà°¿à°ªà°¡à±‡à°¸à±à°¤à±à°¨à±à°¨ à°ªà±à°°à°•à±ƒà°¤à°¿ à°°à°®à°£à±€à°¯ à°¦à±ƒà°¶à±à°¯à°¾à°²à±. à°¤à°ªà±à°ªà°• à°šà±‚à°¡à°¾à°²à±à°¸à°¿à°¨ à°ªà±à°°à°¦à±‡à°¶à°‚.',
        image: 'Picture3.png',
        tags: ['photos', 'trending', 'lifestyle'],
        isFullCard: true
    },
    {
        id: 'local-new-1',
        title: 'à°¨à°—à°°à°‚à°²à±‹ à°Ÿà±à°°à°¾à°«à°¿à°•à± à°¨à°¿à°¬à°‚à°§à°¨à°²à± à°•à° à°¿à°¨à°¤à°°à°‚',
        description: 'à°¹à±†à°²à±à°®à±†à°Ÿà± à°§à°°à°¿à°‚à°šà°¨à°¿ à°µà°¾à°¹à°¨à°¦à°¾à°°à±à°²à°•à± à°­à°¾à°°à±€ à°œà°°à°¿à°®à°¾à°¨à°¾à°²à± à°µà°¿à°§à°¿à°‚à°šà°¨à±à°¨à±à°¨ à°Ÿà±à°°à°¾à°«à°¿à°•à± à°ªà±‹à°²à±€à°¸à±à°²à±.',
        image: 'Picture4.png',
        tags: ['local', 'hyderabad'],
        isFullCard: true
    },
    {
        id: 'cine-new-1',
        title: 'à°“à°Ÿà±€à°Ÿà±€à°²à±‹ à°ˆ à°µà°¾à°°à°‚ à°µà°¿à°¡à±à°¦à°²à°¯à±à°¯à±‡ à°šà°¿à°¤à±à°°à°¾à°²à±',
        description: 'à°‡à°‚à°Ÿà±à°²à±‹à°¨à±‡ à°•à±‚à°°à±à°šà±à°¨à°¿ à°µà°¿à°¨à±‹à°¦à°¾à°¨à±à°¨à°¿ à°†à°¸à±à°µà°¾à°¦à°¿à°‚à°šà°¡à°¾à°¨à°¿à°•à°¿ à°¸à°¿à°¦à±à°§à°‚à°—à°¾ à°‰à°‚à°¡à°‚à°¡à°¿. à°ˆ à°µà°¾à°°à°‚ à°®à±à°šà±à°šà°Ÿà°—à±Šà°²à°¿à°ªà±‡ à°šà°¿à°¤à±à°°à°¾à°² à°œà°¾à°¬à°¿à°¤à°¾.',
        image: 'Picture5.png',
        tags: ['cinema', 'trending']
    },
    {
        id: 'full-ad-1',
        title: 'Special Promotion',
        description: 'Exclusive Ad Page',
        image: '23- Ad Page.png',
        tags: ['main', 'trending'],
        isFullCard: true
    },
    {
        id: 'full-comp-6',
        title: 'Category Complete',
        description: 'You have caught up with all stories.',
        image: '25-Category complete-6.png',
        tags: ['main', 'trending'],
        isFullCard: true
    },
    {
        id: 'full-comp-7',
        title: 'Category Complete',
        description: 'Stay tuned for more updates.',
        image: '25-Category complete-7.png',
        tags: ['main', 'trending'],
        isFullCard: true
    },
    {
        id: 'full-comp-8',
        title: 'Category Complete',
        description: 'Fresh news coming soon.',
        image: '25-Category complete-8.png',
        tags: ['main', 'trending'],
        isFullCard: true
    },
    {
        id: 'full-wish-2',
        title: 'Greetings',
        description: 'Best wishes for you.',
        image: 'wishes2.png',
        tags: ['wishes', 'whatsapp', 'trending'],
        isFullCard: true
    }
];

// Mapping priorities and logic
const getCategoryId = (item, categoryMap) => {
    const tags = item.tags || [];

    // ðŸŒŸ SPECIFIC RULE: wishes + isFullCard -> wishes category
    if (tags.includes('wishes') && item.isFullCard === true) {
        return categoryMap['wishes'];
    }

    // Priority order for mapping tags to categories
    if (tags.includes('whatsapp')) return categoryMap['whatsapp'];
    if (tags.includes('bhakti')) return categoryMap['bhakti'];
    if (tags.includes('affairs')) return categoryMap['affairs'];
    if (tags.includes('lifestyle')) return categoryMap['lifestyle'];
    if (tags.includes('agriculture')) return categoryMap['agriculture'];
    if (tags.includes('cinema')) return categoryMap['cinema'];
    if (tags.includes('sports')) return categoryMap['sports'];

    // Local news detection
    const localTags = ['local', 'hyderabad', 'guntur', 'andhra', 'telangana', 'vijayawada'];
    if (tags.some(tag => localTags.includes(tag))) return categoryMap['local'];

    if (tags.includes('main')) return categoryMap['main'];
    if (tags.includes('trending')) return categoryMap['trending'];

    // Fallback to trending if nothing else matches
    return categoryMap['trending'];
};

async function run() {
    const client = new MongoClient(uri);
    try {
        await client.connect();
        const db = client.db("knewsdb");

        console.log("Fetching categories...");
        const categories = await db.collection("categories").find().toArray();
        const categoryMap = {};
        categories.forEach(cat => {
            categoryMap[cat.slug] = cat._id;
        });

        console.log("Cleaning old data...");
        await db.collection("news").deleteMany({});

        console.log("Processing and inserting news data...");
        const processedNews = newsData.map(item => {
            const categoryId = getCategoryId(item, categoryMap);
            return {
                ...item,
                category_id: categoryId,
                created_at: new Date(),
                updated_at: new Date()
            };
        });

        const result = await db.collection("news").insertMany(processedNews);
        console.log(`${result.insertedCount} news items inserted with correct category references.`);

        // Verify counts
        console.log("--- Verification by Category ---");
        for (const slug of Object.keys(categoryMap)) {
            const count = await db.collection("news").countDocuments({ category_id: categoryMap[slug] });
            console.log(`${slug}: ${count} items`);
        }

    } catch (err) {
        console.error("Migration failed:", err);
    } finally {
        await client.close();
    }
}

run();
